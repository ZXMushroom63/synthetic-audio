<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYNTHETIC</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="public/logo_small.png">
    <link rel="manifest" href="manifest.json" />
</head>
<body>
    <!-- CACHE SERVICE WORKER -->
    <script src="scripts/sw/sw_loader.js"></script>

    <!-- LIBRARIES -->
    <script src="lib/lamejs.min.js"></script>
    <script src="lib/filesaver.min.js"></script>
    <script src="lib/midi_lib.js"></script>

    <!-- GUI MODULES -->
    <script src="scripts/gui/tabs.js"></script>
    <script src="scripts/gui/loop_select.js"></script>
    <script src="scripts/gui/timePosMarker.js"></script>
    <script src="scripts/gui/selectbox.js"></script>
    <script src="scripts/gui/duplicate.js"></script>
    <script src="scripts/gui/clipboard.js"></script>
    <script src="scripts/gui/help.js"></script>
    <script src="scripts/gui/quantiseToNote.js"></script>
    <script src="scripts/gui/vizualiser.js"></script>

    <!-- GUI CORE -->
    <script src="scripts/gui/gui.js"></script>

    <!-- BACKEND -->
    <script src="scripts/backend/importMidi.js"></script>
    <script src="scripts/backend/serialisation.js"></script>
    <script src="scripts/backend/apply_soundbite.js"></script>
    <script src="scripts/backend/waveforms.js"></script>

    <!-- CORE -->
    <script src="scripts/core.js"></script>

    <!-- FILTERS -->
    <script src="scripts/backend/filters/misc.js"></script>
    <script src="scripts/backend/filters/reverb.js"></script>
    <script src="scripts/backend/filters/bandpass.js"></script>
    <script src="scripts/backend/filters/stereoxy.js"></script>
    <script src="scripts/backend/filters/soundwave.js"></script>
    <script src="scripts/backend/filters/waveform.js"></script>
    <script src="scripts/backend/filters/advanced_waveform.js"></script>
    <script src="scripts/backend/filters/procedural_asset.js"></script>

    <table class="main">
        <tr>
            <td style="height: 10rem;">
                <h4>
                    <img id="logo" style="display:none;" src="public/logo.png" height="75">
                    <canvas width="150" height="75" style="border: 1px solid white;"></canvas>
                    <button id="renderBtn" disabled onclick="if(this.disabled){return};render()">Render Audio</button>
                    <audio id="renderOut" controls></audio>
                    <div style="display: inline-block;">
                        <span>Playback Rate: </span><br>
                        <input id="playbackRateSlider" type="range" min="0.075" step="0.01" max="1" value="1" oninput="document.querySelector('#renderOut').playbackRate = parseFloat(this.value)">
                    </div>
                </h4>
                <div id="loopSelector">
                    <label>Select loop folder: </label><input type="file" multiple>
                </div>
                <div id="renderProgress">
                    (no render task currently active)
                </div>
                <div id="controlsAndStuff">
                    <button onclick="saveAs(new Blob([JSON.stringify(serialise())], {type: 'text/json'}), 'mysong.sm')">
                        Save
                    </button>
                    <button onclick="load()">
                        Load
                    </button>
                    <button onclick="deserialise('{}')">
                        Clear
                    </button>
                    <button onclick="viewHelp()">
                        Help
                    </button>
                    <button onclick="updateApp()">
                        Update App
                    </button>
                    <ins></ins>
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <div id="track">
                    <div id="trackInternal">
                        <div id="time">
                        </div>
                        <span class="timePosMarker" style="left: 0%;"></span>
                    </div>
                </div>
            </td>
        </tr>
        <tr>
            <td style="align-content: flex-end; white-space: nowrap; overflow-x: auto;">
                <div id="tray">
                    <span class="trayElem">
                        Editor Layer: <input step="1" min="-10" max="10" type="number" id="editorlayer" value="0">
                    </span>
                    <span class="trayElem">
                        BPM: <input step="1" min="20" max="480" type="number" id="bpm" value="240">
                    </span>
                    <span class="trayElem">
                        Loop Interval: <input step="1" min="0.1" max="16" type="number" id="loopi" value="0.001">
                    </span>
                    <span class="trayElem">
                        Duration: <input step="1" min="1" max="360" type="number" id="duration" value="10">s
                    </span>
                    <span class="trayElem">
                        Stereo: <input checked type="checkbox" id="stereobox">
                    </span>
                    <span class="trayElem">
                        Normalised: <input checked type="checkbox" id="normalisebox">
                    </span>
                    <span class="trayElem">
                        NoLOD: <input checked type="checkbox" id="nolod">
                    </span>
                </div>
            </td>
        </tr>
    </table>
    <div id="addstuff">
        <h4>Add Tracks</h4>
        <details>
            <summary>Loops</summary>
            <div id="addloops">
            </div>
        </details>
        <details>
            <summary>Filters</summary>
            <div id="addfilters">
            </div>
        </details>
        <details>
            <summary>Primitives</summary>
            <div id="addprims">
            </div>
        </details>
    </div>
    <audio id="loopsample"></audio>
    <audio id="loopmeta"></audio>
</body>
</html>